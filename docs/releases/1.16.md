# 1.16 Release Notes

Release date: Mar 2021

> [!CAUTION]
> **This release is out of support and won't receive any new features or bug fixes.** Consider upgrading to the latest stable or preview release as soon as possible. Note that supported (stable and preview) releases are not published on Unity's Asset Store; [register your license](https://naninovel.com/register) to access them.

## Compatibility

Supported Unity versions range: from `2019.4.24` to `2020.3`. Previous versions are not supported; compatibility issues with newer (major) versions will be addressed once they're out of beta.

Recommended Unity version: [`2019.4.24`](https://unity3d.com/unity/whats-new/2019.4.24).

## Upgrade Guide

When importing the package to a project with Naninovel version `1.14` or older first follow [v1.15 release](/releases/1.15) upgrade guide, then continue with the following instructions:

1. Remove `Naninovel` folder from the project before importing the updated package.
2. In case using extension packages, update them using following links:
    - [NaninovelPlayMaker](https://github.com/Elringus/NaninovelPlayMaker/raw/master/NaninovelPlayMaker.unitypackage)
    - [NaninovelLive2D](https://github.com/Elringus/NaninovelLive2D/raw/master/NaninovelLive2D.unitypackage)
    - [AdventureCreator](https://github.com/Elringus/NaninovelAdventureCreator/raw/master/NaninovelAdventureCreator.unitypackage)
3. In case using sprite dicing, update the extension (remove and add it again in the package manager via the same git url).

Remember to keep `NaninovelData/Resources` folder and `NaninovelData/EditorResources.asset` file when updating the engine to preserve project configuration and asset references.

Be aware, that in-game saves (slots in save/load menu, values in settings menu and global game state) created with previous versions could cause unexpected behavior when loaded with the updated version; when patching a shipped project with a new Naninovel version, make sure existing saves work as expected.

In case using [VS Code IDE extension](/guide/ide-extension), check for updates to handle changes in the commands API.

## Added

- Added actor record assets allowing to manage actor metadata records (characters, backgrounds, printers, choice handlers) without using editor menus with support for multi-editing and organizing the records with folders. ([example](https://www.youtube.com/watch?v=2YP-36THHvk))
- Added `pos` (scene position), `position` (world position), `rotation` and `scale` parameters to `@spawn` command allowing to specify transform of the spawned objects.
- Added `ActorPopup` property drawer attribute for drawing list of available actors in the Unity editor.
- Added `GetName` built-in expression function allowing to get display name of a character with the provided ID.
- Added `@unloadScene` command allowing to unload a Unity scene.
- Added `@openURL` command allowing opening specified URL with web browser.
- Added `On Appearance Changed` Unity event to layered actor behavior component.
- Added `Paste Current Composition` context menu item allowing to paste current layered composition expression. ([example](https://i.gyazo.com/5504675e576b653e293fc2553c060ae6.mp4))
- Added gyroscope bindings for camera look to the default input actions.
- Added `Clip Rect Scale` property to revealable TMPro text component allowing to modify the reveal rect size. ([example](https://i.gyazo.com/ec47542b458eaa9a082d05ee4277e93e.png))
- Added `Default Skip Mode` option to script player config allowing to specify default text skip mode to set when the game is first started.
- Added `On Initialization Progress` Unity event to "EngineInitializationUI" for listening progress changed events.
- Added `On Tint Changed` Unity event to text printers allowing reacting to tint color set via `@printer` command. ([example](https://i.gyazo.com/9b083c2d3a26f61dcc2f900e3689e237.png))
- Added `IScriptPlayer.HasPlayed(scriptName)` method, allowing to check whether a script has been previously played.
- Added `Play On Awake` property to `Play Script` component allowing to play the script automatically when the game object is instantiated.
- Added `TMProChat` built-in printer.
- Added `Naninovel TMPro Text` component â€” a wrapper over uGUI text mesh pro with ruby and tips tags and Arabic text support.
- Added `remove` parameter to `@hide`, `@hideAll` and `@hideChars` commands allowing to remove (destroy) resources associated with the hidden actors; can be used instead of `@resetState` to prevent memory leaks.
- Added `Render Rectangle` allowing to specify an area to render when using render actor to texture feature.
- Added parameter for custom (dissolve texture) transition for smoothing (fuzzing) borders of the transition. ([example](https://i.gyazo.com/251d746659c45ccca21f319d5b74dadd.mp4))
- Naninovel scripts will now be automatically removed from the resources list when associated asset is deleted.
- Sprite dicing extension has been updated for better compression efficiency and speed; it now also possible specifying custom pivot in the diced sprites when `Keep Original` (pivot) is enabled in the atlas settings.
- Choice handler buttons will now invoke show/hide events in sync with handler itself allowing to attach a custom behavior when choice is shown/selected.
- Updated built-in TMPro printers to support conservative memory usage, which prevents GC allocations when printed text message length is above certain threshold. If you're using custom printers, disable `Vertex Buffer Auto Size Reduction` on the TMPro text components manually. ([ref issue](https://issuetracker.unity3d.com/product/unity/issues/guid/1305311))
- Optimized script file watcher performance; only directories containing naniscripts will now be watched.
- It's no longer required to restart Unity editor when changing settings related to script file watcher.
- Resources path selection menu now supports sub-menus based on path hierarchy.
- Missing dependency error will now include type of the component that is missing the dependency.
- Game pad left stick will now also trigger focus when UI focus mode is set to navigation.
- Resource editor tooltips are now selectable to allow copy-pasting the script examples.
- It's now possible to import/export localization data into multiple spreadsheets.
- It's now possible using arbitrary enums to autocomplete parameters of custom commands. ([guide](https://github.com/Naninovel/Documentation/blob/9ffc1401ccb25b5b019deb058d043b297e3ccb60/docs/guide/ide-extension.md#ide-attributes))
- IDE extension now support comment folding.
- Spine extension now support multiple materials (submeshes).
- Improved layered actor auto render canvas evaluation.

## Changed

- Minimum supported Unity version changed to 2019.4.24 due to breaking changes in TextMesh Pro package.
- "UniTask" third party library has been stripped and embedded inside Naninovel assembly. Upgrade script to v2 has been removed. UniTask v2 can now be used alongside default Naninovel installation.
- Service access methods in the  `Engine` class have been changed: `GetService` no longer accepts a predicate, use `FindService` instead; `GetAllServices` has been renamed to `FindAllServices`.
- Removed `Correct Render Aspect` option. The aspect will now be corrected by default. To modify the rendered area (viewport), use the added `Render Rectangle` property. ([example](https://i.gyazo.com/7224fa44695507b0ce0274940d630299.png))

## Fixed

- Fixed author name missing in chat messages when display name is not set.
- Fixed resources assigned in editor menus and kept in `Resources` folder, but not under project provider root path not included to build.
- Fixed exception being thrown when attempting to preview layered actor composition while not in prefab mode.
- Fixed exception when building with cloud build service with addressable system installed.
- Fixed addressable labels not automatically added on build.
- Fixed script parser not changing until recompile or editor restart.
- Fixed movie UI blinking white after fade when playing a video for the first time.
- Fixed non-generic `GetService` method not resolving services from interfaces.
- Fixed auto play default input binding for gamepad fails to toggle the auto mode when using input system.
- Fixed quote un-/escaping in parameter values without whitespace.
- Fixed managed text records only applied to the first property in a type.
- Fixed TMPro font variants (weights) and sprites not working with text reveal effect.
- Fixed rotation applied to parent game objects in layered actors is ignored at runtime.
- Fixed entering skip mode prevents rollback to the command from which the skip started.
- Fixed editor resources lost when re-importing all assets or deleting "Library" folder.
- Fixed `@toast` command not included to localization documents.
- Fixed appearance and id parameters of `@back` command not auto-completing for actors other than main (IDE extension).
- Fixed engine pre- and post- initialization tasks not counting toward the reported initialization progress.
- Fixed text line incorrectly revealed when a ruby tag is placed at the end of a line.
- Fixed nullref when invoking `LayeredActorBehaviour.RebuildLayers()` at runtime.
- Fixed movie volume not affected by master volume setting.
- Fixed minor alpha blending artifacts when performing scene transitions.
- Fixed actors appear darker then they should be in semi-transparent areas.
- Fixed nullref when using preview composition of layered actor while gizmos are disabled.
- Fixed layered actor size distorted when using RebuildLayers method at runtime.
- Fixed title script labels not played when wait for input is enabled.
- Fixed expression function exceptions suppressed and not logged correctly.
- Fixed incorrect actor texture scaling when transitioning between appearances with different sizes.
- Fixed text incorrectly revealed and input indicator missing after saving game.
- Fixed duplicate rollback step added after loading a saved game.
